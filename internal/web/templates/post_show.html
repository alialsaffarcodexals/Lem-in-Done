{{define "post_show.html"}}{{template "layout.html" .}}{{end}}

{{define "title"}}{{.Post.Title}}{{end}}
{{define "content"}}
<article class="card">
  <h2 style="margin:0 0 6px">{{.Post.Title}}</h2>
  <div style="font-size:12px;color:#6b7280">by {{.Post.Username}} • {{.Post.CreatedAt}}</div>
  <p>{{.Post.Body}}</p>
  <div>
    {{range .Post.Categories}}<span class="tag">{{.}}</span>{{end}}
  </div>
  <div style="margin-top:8px">
    <form class="inline" method="post" action="/like">
      <input type="hidden" name="type" value="post">
      <input type="hidden" name="id" value="{{.Post.ID}}">
      <input type="hidden" name="value" value="1">
      <button class="btn" type="submit">👍 {{.Post.Likes}}</button>
    </form>
    <form class="inline" method="post" action="/like">
      <input type="hidden" name="type" value="post">
      <input type="hidden" name="id" value="{{.Post.ID}}">
      <input type="hidden" name="value" value="-1">
      <button class="btn" type="submit">👎 {{.Post.Dislikes}}</button>
    </form>
  </div>
</article>

<section class="card">
  <h3 style="margin-top:0">Comments</h3>
  {{range .Comments}}
    <div class="card" style="margin:8px 0">
      <div style="font-size:12px;color:#6b7280">{{.Username}} • {{.CreatedAt}}</div>
      <p>{{.Body}}</p>
      <div>
        <form class="inline" method="post" action="/like">
          <input type="hidden" name="type" value="comment">
          <input type="hidden" name="id" value="{{.ID}}">
          <input type="hidden" name="value" value="1">
          <button class="btn" type="submit">👍 {{.Likes}}</button>
        </form>
        <form class="inline" method="post" action="/like">
          <input type="hidden" name="type" value="comment">
          <input type="hidden" name="id" value="{{.ID}}">
          <input type="hidden" name="value" value="-1">
          <button class="btn" type="submit">👎 {{.Dislikes}}</button>
        </form>
      </div>
    </div>
  {{else}}
    <p>No comments yet.</p>
  {{end}}

  {{if .LoggedIn}}
  <form method="post" action="/comment/new" style="margin-top:12px">
    <input type="hidden" name="post_id" value="{{.Post.ID}}">
    <label>Your comment</label>
    <textarea name="body" rows="4" required></textarea>
    <div style="margin-top:8px"><button class="btn primary" type="submit">Add comment</button></div>
  </form>
  {{else}}
    <p><a href="/login">Login</a> to comment.</p>
  {{end}}
</section>
{{end}}
